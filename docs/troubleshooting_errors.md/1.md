When something does pop up, here’s a tiny triage you can run in under a minute:

1. Pinpoint the file
bin/rails zeitwerk:check      # autoload/name issues
ruby -c path/to/file.rb       # syntax on just that file

2. If it’s syntax-y: show hidden junk
LC_ALL=C sed -n '1,120p' path/to/file.rb | cat -v
# look for smart quotes, ^M, weird spaces

3. Quick clean (single file)
perl -i -pe 's/\r$//' path/to/file.rb
tr -cd '\11\12\15\40-\176' < path/to/file.rb > /tmp/clean && mv /tmp/clean path/to/file.rb

4.Restart anything cached
spring stop 2>/dev/null || true

5. If you want this to guardrail future commits, drop this pre-commit hook

# .git/hooks/pre-commit (chmod +x)
#!/usr/bin/env bash
set -euo pipefail

# normalize endings on staged files
files=$(git diff --cached --name-only --diff-filter=ACMR | grep -E '\.(rb|erb|rake)$' || true)
[ -z "$files" ] && exit 0

for f in $files; do
  [ -f "$f" ] || continue
  perl -i -pe 's/\r$//' "$f"
  tmp=$(mktemp); tr -cd '\11\12\15\40-\176' < "$f" > "$tmp" && mv "$tmp" "$f"
  ruby -c "$f" >/dev/null
done

# catch autoload issues fast
bin/rails zeitwerk:check >/dev/null
git add $files

VS Code tip: ⌘⇧P → “Toggle Render Whitespace” and enable Unicode Highlight (invisibles + ambiguous) — you’ll see the culprits instantly.

# Ruby syntax check a model
ruby -c app/models/soldier.rb

# Show file with control chars visible (helps catch weird unicode)
LC_ALL=C sed -n '1,200p' app/models/soldier.rb | cat -v

Model loads & associations (rails runner is safer than console for one-offs)
# Confirm model constant loads
bin/rails r "puts Soldier.name"

# Reflect on associations
bin/rails r "p Soldier.reflect_on_association(:cemetery)&.macro"
bin/rails r "p Soldier.reflect_on_association(:awards)&.macro"
bin/rails r "p War.reflect_on_association(:involvements)&.macro"

# Basic instance touch
bin/rails r "s = Soldier.first; puts(s ? (s.cemetery&.name || 'no cemetery') : 'no soldiers')"

Grep for duplicate/missing bits (portable grep)
